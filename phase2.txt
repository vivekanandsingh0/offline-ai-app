Offline-First AI Study Assistant (Nursery‚ÄìClass 10)

1. PRODUCT SCOPE (LOCKED)
What this product IS

A local-only, offline-first AI assistant

Built for school students (Nursery ‚Üí Class 10)

Optimized for:

Explanations

Notes

Practice

Homework guidance

Designed to work without internet

Uses small local models (Phi-2 default)

What this product is NOT (for now)

‚ùå General ChatGPT alternative

‚ùå P2P network

‚ùå Token / crypto system

‚ùå Cloud AI replacement

‚ùå Open-ended creativity app

This scope discipline is critical.

2. HIGH-LEVEL ARCHITECTURE (CURRENT ‚Üí TARGET)
Current (you already have)
UI (Chat)
  ‚Üì
Local Prompt
  ‚Üì
llama.cpp (single model)
  ‚Üì
Response shown

Target (after implementing this doc)
UI (Chat + Tools)
  ‚Üì
Tool Selection
  ‚Üì
Class Context
  ‚Üì
Prompt Builder (layered)
  ‚Üì
Model Selector (auto)
  ‚Üì
llama.cpp
  ‚Üì
Post-processing & Safety
  ‚Üì
Response + Cache


We are adding control layers, not rewriting the app.

3. CORE DESIGN PRINCIPLES (DO NOT SKIP)

These principles guide every implementation decision.

Local AI must feel useful, not impressive

Students need predictability, not creativity

Tools > Free chat

Speed perception > raw speed

Safety > intelligence

Control the model, don‚Äôt trust it

4. USER FLOW (END-TO-END)
First Launch Flow

App opens

Ask once:

‚ÄúWhich class are you studying in?‚Äù

Store locally:

{
  "userClass": 6
}


No login. No account.

Daily Usage Flow

Student opens app

Chat screen loads

Tool bar visible above input

Student selects a tool (or none)

Student types input

App builds structured prompt

Local model runs

Response shown

Response cached

5. TOOL SYSTEM (MOST IMPORTANT PART)
Why tools exist

Local models are:

slower

smaller

weaker at open-ended chat

Tools:

narrow intent

reduce reasoning load

increase accuracy

improve speed perception

Final Tool List (MVP)

You will implement exactly these 5:

Explain Topic

Make Short Notes

Practice Questions

Homework Helper

Simplify / Translate

No more. No less.

Tool Selection UI (already decided)

Tool selector inside chat

One tool active at a time

Tool shown as a pill:

üõ† Explain Topic  [√ó]

6. CLASS HANDLING SYSTEM (CRITICAL)
Why class handling matters

Without class control:

wrong depth

wrong language

parent distrust

syllabus violations

Implementation Strategy
A. Store class once
userClass = 6

B. Inject class into EVERY prompt

No exceptions.

C. Restrict tools by class
Tool	Nursery‚Äì2	3‚Äì5	6‚Äì8	9‚Äì10
Explain Topic	‚úÖ	‚úÖ	‚úÖ	‚úÖ
Short Notes	‚ùå	‚úÖ	‚úÖ	‚úÖ
Practice Questions	‚ùå	‚úÖ	‚úÖ	‚úÖ
Homework Helper	‚ùå	‚ùå	‚úÖ	‚úÖ
Simplify / Translate	‚úÖ	‚úÖ	‚úÖ	‚úÖ

This logic lives in code, not the model.

7. MODEL STRATEGY (FINAL)
Default Model

Phi-2 2.7B Instruct (quantized)

Reason:

Best balance of speed + reasoning

Excellent for educational tasks

Works well with structured prompts

Optional Secondary Models

TinyLlama ‚Üí ultra-fast fallback

Llama 3.3 3B ‚Üí ‚ÄúDetailed‚Äù mode only

But:

Phi-2 handles 90% of all requests

8. PROMPT ARCHITECTURE (VERY IMPORTANT)
Prompt is BUILT IN LAYERS

You are not sending one raw prompt.

You are composing it like this:

[BASE SYSTEM PROMPT]
      +
[SAFETY PROMPT]
      +
[CLASS CONTEXT PROMPT]
      +
[TOOL PROMPT]
      +
[USER INPUT]


This guarantees control.

Prompt Builder (Conceptual)
finalPrompt =
  basePrompt +
  safetyPrompt +
  classPrompt(userClass) +
  toolPrompt(activeTool, userClass) +
  userInput


This function is the brain of your app.

9. SAFETY & SECURITY (NON-NEGOTIABLE)
Topics that must NEVER be answered

Sexual content

Violence

Drugs

Politics

Religion

Medical advice

Self-harm

Handling strategy

Calm refusal

School-appropriate explanation

Suggest parent/teacher

Never say:

‚ÄúI am not allowed‚Äù

Say:

‚ÄúThis topic is not appropriate for school students.‚Äù

10. HOMEWORK HELPER (SPECIAL CASE)

This tool has extra rules.

Default behavior

Explain thinking

Give steps

Give hints

NO final answer

Exception

Only if:

Class ‚â• 9

User explicitly asks for answer

This protects you from:

School complaints

Parent backlash

11. PERFORMANCE OPTIMIZATION (LOCAL AI REALITY)
The problem

Local AI is slow sometimes.

The solution

Make it FEEL fast.

Required optimizations
A. Short default outputs

Limit words. Expand only on demand.

B. Progress messages

‚ÄúThinking‚Ä¶‚Äù

‚ÄúPreparing explanation‚Ä¶‚Äù

Silence feels broken. Progress feels intentional.

C. Local Caching (VERY IMPORTANT)

Hash key:

(class + tool + subject + input)


If cached:

Return instantly

Skip inference

School questions repeat heavily.

12. ERROR & FAILURE HANDLING
If model output is bad

Do NOT show garbage

Show safe fallback:

‚ÄúI couldn‚Äôt explain this clearly. Try rephrasing or ask a teacher.‚Äù

If model hangs

Timeout

Cancel

Retry option

Never freeze UI.

13. WHAT TO IMPLEMENT FIRST (ORDER MATTERS)
Phase 1 (Must be done)

Tool system in chat

Class selection & storage

Prompt builder with layers

Phi-2 as default model

Phase 2

Safety enforcement

Homework helper restrictions

Tool-class mapping

Phase 3

Caching

Performance UX polish

Edge-case handling

14. WHAT SUCCESS LOOKS LIKE (THIS STAGE)

You are successful if:

A Class 6 student can:

Explain a topic

Make notes

Practice questions

Offline

Safely

Predictably

Without confusion

That alone is a real product.

15. WHAT YOU MUST NOT DO NOW

‚ùå Add P2P

‚ùå Add crypto

‚ùå Add training

‚ùå Add big models

‚ùå Add open-ended chat focus

These are future layers, not foundations.

16. FUTURE-PROOFING (JUST FOR CLARITY)

Later (not now), you can add:

P2P as quality boost

GPU nodes as premium

Tokens as incentive

All of that depends on this base being solid.

FINAL WORD (IMPORTANT)

You are no longer ‚Äúbuilding an AI app‚Äù.

You are:

Designing a controlled educational system that uses AI as a tool.

That mindset is why this will work.